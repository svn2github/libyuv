= Getting Started =

How to get and build the libyuv code.

== Pre-requisite = 

You'll need to have depot tools installed:

https://sites.google.com/a/chromium.org/dev/developers/how-tos/depottools

== Getting the Code =

Create a working directory, enter it, and run:

gclient config http://libyuv.googlecode.com/svn/trunk<br>
gclient sync

The sync will generate native build files for your environment using gyp (Windows: Visual Studio, OSX: XCode, Linux: make). This generation can also be forced manually:

gclient runhooks V=1 <br>

== Getting Clang for Linux =

Linux doesn't use clang by default, you have to download it manually the first time:

/tools/clang/scripts/update.sh

== Building the Library = 

=== Windows =

devenv -build "Debug" libyuv.sln <br>
devenv -build "Release" libyuv.sln <br>

=== OSX =

xcodebuild -project libyuv.xcodeproj -configuration Debug <br>
xcodebuild -project libyuv.xcodeproj -configuration Release <br>

=== Linux =

make -j6 V=1 -r libyuv BUILDTYPE=Debug <br>
make -j6 V=1 -r libyuv BUILDTYPE=Release <br>

=== Windows Shared Library =

Modify libyuv.gyp from 'static_library' to 'shared_library', and add 'LIBYUV_BUILDING_SHARED_LIBRARY' to 'defines'. Then run this.<br>
gclient runhooks <br>
After this command follow the building the library instructions above.<br>

If you get a compile error for atlthunk.lib on Windows, read http://www.chromium.org/developers/how-tos/build-instructions-windows

== GYP_DEFINES = 

To build other variations of the library, first set GYP_DEFINES environment variable, then regenerate the build files using gclient runhooks.

=== 64 bit Windows =

set GYP_DEFINES=target_arch=x64 <br>
gclient runhooks V=1 <br>

=== ARM Linux =

$ export GYP_DEFINES="target_arch=arm armv7=1" <br>
$ export CROSSTOOL=`<path>`/arm-none-linux-gnueabi <br>
$ export CXX=$CROSSTOOL-g++ <br>
$ export CC=$CROSSTOOL-gcc <br>
$ export AR=$CROSSTOOL-ar <br>
$ export AS=$CROSSTOOL-as <br>
$ export RANLIB=$CROSSTOOL-ranlib <br>
$ gclient runhooks <br>

== Building and Running Unittests = 

=== Windows =

devenv -build "Debug" libyuv_test.sln <br>
devenv -build "Release" libyuv_test.sln  <br>
build\release\libyuv_unittest.exe --gtest_catch_exceptions=0 --gtest_filter=`*` <br>

=== OSX =

xcodebuild -project libyuv_test.xcodeproj -configuration Debug <br>
xcodebuild -project libyuv_test.xcodeproj -configuration Release <br>
xcodebuild/Release/libyuv_unittest --gtest_filter=`*` <br>

=== Linux =

make -j6 V=1 -r libyuv_unittest BUILDTYPE=Debug <br>
make -j6 V=1 -r libyuv_unittest BUILDTYPE=Release <br>
out/Release/libyuv_unittest --gtest_filter=`*` <br>

Replace --gtest_filter=`*` with specific unittest to run.  May include wildcards. e.g.

out/Release/libyuv_unittest --gtest_filter=libyuvTest.I420ToARGB_OptVsC <br>

== Benchmarking =

The unittests can be used to benchmark.<br>

set LIBYUV_REPEAT=1000<br>
build\release\libyuv_unittest.exe --gtest_filter=*I420ToARGB*<br>

libyuvTest.I420ToARGB_OptVsC (863 ms)<br>
Indicates 0.863 ms/frame for 1280 x 720.